<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="riskassessment">
<title>Deployment • riskassessment</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deployment">
<meta property="og:description" content="riskassessment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">riskassessment</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/riskassessment.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>User Guides</h6>
    <a class="dropdown-item" href="../articles/Credential_Manager.html">Credential Manager</a>
    <a class="dropdown-item" href="../articles/User_Roles_and_Privileges.html">User Roles and Privileges</a>
    <a class="dropdown-item" href="../articles/Deployment.html">Deployment</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaR/riskassessment/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Deployment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaR/riskassessment/blob/HEAD/vignettes/Deployment.Rmd" class="external-link"><code>vignettes/Deployment.Rmd</code></a></small>
      <div class="d-none name"><code>Deployment.Rmd</code></div>
    </div>

    
    
<p>To reap all the advantages of the <code>riskassessment</code>
application, an organization needs to generate and store results
frequently derived from the app, including but not limited to:</p>
<p><img src="images/deploy_rocket.png" style="float:right; height:140px"></p>
<ol style="list-style-type: decimal">
<li>Uploading new packages, &amp; storing their metric info and
<code>riskmetric</code> score</li>
<li>Publishing reviewer comments</li>
<li>Submitting package decisions</li>
<li>Storing organization-wide metric weights and score-based thresholds
for decision automation</li>
<li>Credential management for authorized users</li>
<li>Etc</li>
</ol>
<p>To accomplish this, the app uses configuration settings to create and
populate several storage solutions locally, in the app’s root
directory:</p>
<ul>
<li>A <code>SQLite</code> database named <code>credentials.sqlite</code>
(by default) for credential management</li>
<li>A json file named <code>loggit.json</code> (by default), recording
rudimentary logs of actions performed in the app</li>
<li>A <code>SQLite</code> database named <code>database.sqlite</code>
(by default) for storing all pkg info, metric info, and comments/
decisions</li>
</ul>
<p>Note that this article won’t cover the credentials database since
that’s that’s been covered (at length) in the <a href="../articles/Credential_Manager.html">“Credential Manager”
guide</a>. As you might expect, some deployment environments come with
limitations that are not amicable to storage method defined above!
Spoiler alert - shinyapps.io is one of them. This article will provide
more details about these crucial storage objects and share a run down of
the following deployment options with helpful tips:</p>
<ul>
<li><p>shinyapps.io</p></li>
<li><p>RStudio Connect</p></li>
<li><p>Shiny Server</p></li>
<li><p>ShinyProxy</p></li>
</ul>
<p>Note! In the future, we’ll consider adding utilities that would allow
users to connect to an external, or remote storage method (like a
database).</p>
<p><br></p>
<div class="section level2">
<h2 id="installing-vs-forking">Installing vs Forking<a class="anchor" aria-label="anchor" href="#installing-vs-forking"></a>
</h2>
<p>Before we discuss deployment methods, we should note that the
<a href="https://github.com/pharmaR/riskassessment" class="external-link">riskassessment</a> application is developed using
<a href="https://rstudio.github.io/renv/" class="external-link">renv</a> as a form of source control. This helps maintain
stability in the code base. While you can install
<a href="https://github.com/pharmaR/riskassessment" class="external-link">riskassessment</a> from Github, it is strongly recommended to
use a fork of the <a href="https://github.com/pharmaR/riskassessment" class="external-link">riskassessment</a> repository for
deployment. This will serve a handful or purposes for your
organization:</p>
<ol style="list-style-type: decimal">
<li>You can utilize <a href="https://rstudio.github.io/renv/" class="external-link">renv</a> in your deployment to help
ensure you share the same environment as the app developers, ensuring
consistent behavior.</li>
<li>You will have easier access to the configuration file allowing for a
more streamlined deployment if you have several projects.</li>
</ol>
<p><br></p>
</div>
<div class="section level2">
<h2 id="the-db-config-yml-file">The <code>db-config.yml</code> file<a class="anchor" aria-label="anchor" href="#the-db-config-yml-file"></a>
</h2>
<p>Starting with <code>{riskassessment} v1.0.0</code>, a configuration
file can be found at <code>inst/db-config.yml</code> which is used to
initialize the application for deployment. This configuration contains
elements vital to app initialization and will only grow as development
continues. Many of the elements in the file are also editable from
within the application itself (provided your user role has the
privileges to do so). Currently, <code>db-config.yml</code> contains the
following major elements:</p>
<ul>
<li>
<strong>assessment_db</strong>: A string designating the file path
of the assessment SQLite database (will be created upon initialization).
It has a default value of <code>database.sqlite</code>.</li>
<li>
<strong>credential_db</strong>: A string designating the file path
of the credentials SQLite database (will be created upon
initialization). It has a default value of
<code>credentials.sqlite</code>.</li>
<li>
<strong>loggit_json</strong>: A string designating the file path of
the logging JSON file (will be created upon initialization). It has a
default value of <code>loggit.json</code>.</li>
<li>
<strong>credentials</strong>: A list defining user roles and
privileges to assigned to those roles in the credentials database.</li>
<li>
<strong>decisions</strong>: A list defining decision categories,
automated decision rules (optional), and custom decision category colors
(also optional).</li>
<li>
<strong>metric_weights</strong>: A list containing the
<a href="https://pharmar.github.io/riskmetric/" class="external-link">riskmetric</a> weights to use upon initialization. These
weights are used to increase and decrease the priority of any one
metric.</li>
</ul>
<p>Below is a look at the current default configuration if you were to
fork the <a href="https://github.com/pharmaR/riskassessment" class="external-link">riskassessment</a> code today:</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> database.sqlite</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">loggit_json</span><span class="kw">:</span><span class="at"> loggit.json</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">credential_db</span><span class="kw">:</span><span class="at"> credentials.sqlite</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">credentials</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">roles</span><span class="kw">:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> admin</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> lead</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> reviewer</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">privileges</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">admin</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">admin</span><span class="kw">,</span><span class="at"> weight_adjust</span><span class="kw">,</span><span class="at"> auto_decision_adjust</span><span class="kw">,</span><span class="at"> final_decision</span><span class="kw">,</span><span class="at"> revert_decision</span><span class="kw">,</span><span class="at"> add_package</span><span class="kw">,</span><span class="at"> delete_package</span><span class="kw">]</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">lead</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">weight_adjust</span><span class="kw">,</span><span class="at"> auto_decision_adjust</span><span class="kw">,</span><span class="at"> final_decision</span><span class="kw">,</span><span class="at"> revert_decision</span><span class="kw">,</span><span class="at"> add_package</span><span class="kw">,</span><span class="at"> delete_package</span><span class="kw">]</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">reviewer</span><span class="kw">:</span><span class="at"> add_package</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">decisions</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">categories</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Low Risk</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Medium Risk</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> High Risk</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">metric_weights</span><span class="kw">:</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">covr_coverage</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span></code></pre></div>
<p><br></p>
<div class="section level3">
<h3 id="configuring-the-assessment-database">Configuring the assessment database<a class="anchor" aria-label="anchor" href="#configuring-the-assessment-database"></a>
</h3>
<p><img src="images/SQLite.png" style="float:right; height:80px"></p>
<p>When the <code><a href="../reference/run_app.html">riskassessment::run_app()</a></code> function is ran, the
code base will check if an assessment sqlite file exists by the name you
give it (default is <code>database.sqlite</code>) and if it doesn’t, <a href="https://github.com/pharmaR/riskassessment/tree/master/inst/sql_queries" class="external-link">several
tables will be initiated</a> to create this database just before the app
launches. Note that the user has the authority to name the database file
to whatever they like using the <code>inst/db-config.yml</code> file.
There, you can include a file path preceding the file name if you wish
to move the location of the database away from the root directory. For
example, the following code would create a database called
“database.sqlite” in the <code>dev/</code> folder:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> ./dev/database.sqlite</span></span></code></pre></div>
<p>At the time this vignette was authored, the database will initialize
the following tables with all <code>NULL</code> values:</p>
<ul>
<li>
<code>comments</code>: stores user comments, including user names
associated with each comment entry, comment type, and timestamp</li>
<li>
<code>community_usage_metrics</code>: stores CRAN package downloads
per month</li>
<li>
<code>metric</code>: stores metric info, including the
<code>riskmetric</code> name, label, short description, type, and
weight</li>
<li>
<code>package_metrics</code>: stores all package-specific
<code>rismetric</code> metrics</li>
<li>
<code>package</code>: Contains all package information, like name,
version, maintainer, etc. It also contains a the <code>riskmetric</code>
score, the weighted score, decision, and timestamp.</li>
</ul>
<p>Note: if any changes/ updates occur in these tables with a new
release of <code>riskassessment</code>, you may need to delete the
database file before re-running the app. Any such changes should be
announced as ‘breaking changes’ in the app. If so, remember to save a
copy of your current database file in another directory for backup
purposes.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="database-log-file-config">Database log file config<a class="anchor" aria-label="anchor" href="#database-log-file-config"></a>
</h3>
<p>As mentioned previously, the <code>loggit.json</code> file is
initiated to track general actions performed in the application,
especially those that would reflect a change in the assessment db
(<code>database.sqlite</code> file). At the time this vignette was
authored, here’s a summary of actions logged:</p>
<ul>
<li>App start up</li>
<li>User log-ins</li>
<li>Enabling/ Disabling or changing automated decision rules</li>
<li>Decisions initiated by users or the decision automation rules,
including</li>
<li>When pkgs are added or removed from the database, or when there are
issues with this process, like when there is an absence of data to that
support certain metrics</li>
<li>Re-weighting pkg metrics</li>
<li>Any database issues or conflicts that may arise</li>
</ul>
<p>Each loggit “transaction” recorded contains a lot of info, but most
notably, it will contain a time stamp, record type (“info”, “warn”, or
“error”), and a message. For database transactions, the message will
usually include the query that was executed. All log entries are always
printed out in the R console for your convenience. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>riskassessment<span class="sc">::</span><span class="fu">run_app</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"Log file set to loggit.json"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Listening on http<span class="sc">:</span><span class="er">//</span><span class="dv">127</span>.<span class="dv">0</span>.<span class="fl">0.1</span><span class="sc">:</span><span class="dv">4097</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> {<span class="st">"timestamp"</span><span class="sc">:</span> <span class="st">"2023-03-20T11:46:23-0400"</span>, <span class="st">"log_lvl"</span><span class="sc">:</span> <span class="st">"INFO"</span>, <span class="st">"log_msg"</span><span class="sc">:</span> <span class="st">"User admin signed on as admin"</span>}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> {<span class="st">"timestamp"</span><span class="sc">:</span> <span class="st">"2023-03-20T11:46:33-0400"</span>, <span class="st">"log_lvl"</span><span class="sc">:</span> <span class="st">"INFO"</span>, <span class="st">"log_msg"</span><span class="sc">:</span> <span class="st">"The following decision rules were implemented by admin (admin): Medium = (0.33__COMMA__ 0.66]; Low = (0__COMMA__ 0.33]; High = (0.66__COMMA__ 1]."</span>}</span></code></pre></div>
<p>Feel free to use this information as you see fit! Similar to the
<code>assessment_db</code> parameter in <code>inst/db-config</code>, you
can name the file whatever you like, and save it in an any directory
you’d like. Below, we save it in the <code>dev/</code> folder and name
it “loggit.json”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> ./dev/database.sqlite</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> ./dev/loggit.json</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="credentials-configuration">Credentials configuration<a class="anchor" aria-label="anchor" href="#credentials-configuration"></a>
</h3>
<p>Similar to the assessment database, when the
<code><a href="../reference/run_app.html">riskassessment::run_app()</a></code> function executes, the code base
will check if an credentials sqlite file exists by the name you give it
(default is <code>credentials.sqlite</code>) and if it doesn’t,
<code>riskassessment</code> will initiate this new database before the
app launches. Note that the user has the authority to name the database
sqlite file whatever they desire using <code>inst/db-config.yml</code>.
There, you can include a file path preceding the file name if you wish
to move the location of the database away from the root directory. For
example, the following code would create a database called
“credentials.sqlite” in the <code>dev/</code> folder:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> ./dev/database.sqlite</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">assessment_db</span><span class="kw">:</span><span class="at"> ./dev/loggit.json</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">credential_db</span><span class="kw">:</span><span class="at"> ./dev/credentials.sqlite</span></span></code></pre></div>
<p>Right after the <strong>credentials_db</strong> element is used, the
<strong>credentials</strong> element (with two sub-elements:
<strong>roles</strong> and <strong>privileges</strong>) must be
populated. As a guide, below is a snippet of the default values for
these elements, but we encourage you to design the configuration that
works for you (or your organization).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">credentials</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">roles</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> admin</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> lead</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> reviewer</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">privileges</span><span class="kw">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">admin</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">admin</span><span class="kw">,</span><span class="at"> weight_adjust</span><span class="kw">,</span><span class="at"> auto_decision_adjust</span><span class="kw">,</span><span class="at"> final_decision</span><span class="kw">,</span><span class="at"> revert_decision</span><span class="kw">,</span><span class="at"> add_package</span><span class="kw">,</span><span class="at"> delete_package</span><span class="kw">]</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">lead</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">weight_adjust</span><span class="kw">,</span><span class="at"> auto_decision_adjust</span><span class="kw">,</span><span class="at"> final_decision</span><span class="kw">,</span><span class="at"> revert_decision</span><span class="kw">,</span><span class="at"> add_package</span><span class="kw">,</span><span class="at"> delete_package</span><span class="kw">]</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">reviewer</span><span class="kw">:</span><span class="at"> add_package</span></span></code></pre></div>
<p>Note the <a href="../articles/User_Roles_and_Privileges.html">“User
Roles and Privileges” guide</a> is entirely dedicated to this config.
For full details, please visit &amp; read that article!</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="decisions-configuration">Decisions configuration<a class="anchor" aria-label="anchor" href="#decisions-configuration"></a>
</h3>
<p>The <strong>decisions</strong> element contains up to three
sub-elements: <strong>categories</strong> (mandatory),
<strong>rules</strong>, and <strong>colors</strong>. Here is a snipped
from one of the example configurations:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisions</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">categories</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Insignificant Risk</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Minor Risk</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Moderate Risk</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Major Risk</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Severe Risk</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">rules</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Insignificant Risk</span><span class="kw">:</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fl">.1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Severe Risk</span><span class="kw">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fl">.7</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">colors</span><span class="kw">:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Moderate Risk</span><span class="kw">:</span><span class="at"> !expr grDevices::rgb(52, 235, 229, maxColorValue = 255)</span></span></code></pre></div>
<p>Notice that you can set as many decision <code>categories</code> as
you wish, but you must specify at least two! If you want to set up
automatic decision rules before deploying the app, you can do so using
the <code>rules</code> element. Just list the category name and
underneath it, a mutually exclusive range of values so that when a
package is uploaded, if it’s risk score falls between those values, it
will automatically get labelled with the appropriate decision.
Categories not addressed under the <code>rules</code> banner will not
receive automated decisions. However, users with this privilege can
change this configuration in the app at a later time.</p>
<p>Similarly for <code>colors</code>, you can detail specific colors be
assigned to certain categories. If you don’t care what color is used for
each category, then a color-blind friendly color palette is used to fill
in the rest.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="metric-weights-configuration">Metric weights configuration<a class="anchor" aria-label="anchor" href="#metric-weights-configuration"></a>
</h3>
<p>The <strong>metric_weights</strong> element contains the named list
of weights. If a weight is not supplied, it will default to 1. The
current list of weights that can be included are the following:
has_vignettes, has_news, news_current, has_bug_reports_url, has_website,
has_maintainer, has_source_control, export_help, bugs_status, license,
covr_coverage, downloads_1yr. As seen above, the default configuration
sets the weight for <code>covr_coverage</code> to 0. If you want to
ignore a certain metric because it has little value to our organization,
you could give it a value of zero.</p>
<p>When metrics are not explicitly given here, the app uses the default
weight of 1 for each, unless of course there already exists a assessment
database previously initialized where those metric weights were manually
changed. If you wanted to toggle all current metrics, there is no harm
in stating each metric and weight, so you could set up the config file
to look like this, for example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_weights</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_vignettes</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_news</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.5</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">news_current</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_bug_reports_url</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_website</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_maintainer</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">has_source_control</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">export_help</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">bugs_status</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">license</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">downloads_1yr.</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">covr_coverage</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span></code></pre></div>
<p><a href="https://pharmar.github.io/riskmetric/" class="external-link">riskmetric</a> will use these weights to score your
package according to our org’s needs!</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="deployment-options">Deployment options<a class="anchor" aria-label="anchor" href="#deployment-options"></a>
</h2>
<center>
<img src="images/deploy_general.png" style="height:220px">
</center>
<p><br></p>
<div class="section level3">
<h3 id="shinyapps-io">shinyapps.io<a class="anchor" aria-label="anchor" href="#shinyapps-io"></a>
</h3>
<p>Beware: shinyapps.io <strong>does not</strong> offer persistent
storage of <code>riskassessment</code>’s <code>SQLite</code> database or
logs. Thus, it <strong>is not</strong> likely a viable deployment option
for your organization or group. For example, our <a href="https://rinpharma.shinyapps.io/riskassessment" class="external-link">demo
application</a> (hosted on shinyapps.io) contains a pre-prepared
database of packages that can’t be permanently altered. It CAN be
altered within a session, but any changes <strong>will not</strong>
persist outside the session.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="posit-connect-shiny-server">Posit Connect &amp; Shiny Server<a class="anchor" aria-label="anchor" href="#posit-connect-shiny-server"></a>
</h3>
<p><img src="images/deploy_posit_rsconnect_logo.png" style="float:right; height:160px"></p>
<p><br></p>
<p>On a server, if you want to save files on disk, you’ll need to set
write permissions accordingly on the folder you want to save the
database, logs, and auto-decision json file.</p>
<p>On Posit Connect, you need to use an absolute path to specify the
directory where to save the files. You can find more information here:
<a href="https://support.rstudio.com/hc/en-us/articles/360007981134-Persistent-Storage-on-RStudio-Connect" class="external-link">Persistent
Storage on Posit Connect</a>.</p>
<p><br></p>
<p>Beyond that, it’s important to note that we strongly encourage those
deploying the app to take advantage of the <code>renv.lock</code> file
used to maintain package version dependencies. For more information on
how to use <code>renv.lock</code> and our general dev philosophy as it
pertains to package management, please read the <a href="https://pharmar.github.io/riskassessment/articles/dev_renv.html">“Using
<code>renv</code>”</a> article. Highly related, we encourage the use of
git-backed deployment when possible. So, immediately after you
update/sync your package dependencies using <code>renv</code>, you may
want to run <code>rsconnect::writeManifest()</code> before deploying
from a dedicated branch. For more information on git-backed deployment
&amp; manifest files, please read the Posit article on <a href="https://docs.posit.co/connect/user/git-backed/" class="external-link">git-backed
content</a>.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="shinyproxy">ShinyProxy<a class="anchor" aria-label="anchor" href="#shinyproxy"></a>
</h3>
<p><img src="images/deploy_shinyproxy.png" style="float:right; height:160px"></p>
<p>With <a href="https://www.shinyproxy.io/" class="external-link">ShinyProxy</a>, you can use
a Docker volume to write files outside of the application container. In
<code>application.yml</code>, you use can something like this in the
specs describing the application:</p>
<blockquote>
<p>container-volumes: [ “/var/log/shinylogs:/root/logs” ]</p>
</blockquote>
<p><code>/var/log/shinylogs</code> is a directory on the server where
you deploy your applications with ShinyProxy. <code>/root/logs</code> is
a directory inside your Docker image.</p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aaron Clark, Robert Krajcik, Jeff Thompson, Lars Andersen, Andrew Borgman, Marly Gotti, Maya Gans, Aravind Reddy Kallem, Fission Labs India Pvt Ltd, PSI special interest group Application and Implementation of Methodologies in Statistics, R Validation Hub.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
